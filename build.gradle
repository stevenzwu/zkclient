apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'idea'
apply plugin: 'maven'
apply plugin: 'signing'
apply plugin: 'project-reports'
apply plugin: 'osgi'

group = 'com.101tec'
version = '0.3-nf1'
sourceCompatibility = 1.6

jar {
    manifest {
        attributes 'Implementation-Title': 'ZkClient', 'Implementation-Version': version
    }
}


//--------------------
// Dependencies
//--------------------
repositories {
    flatDir(dirs: 'lib')
	// mavenCentral()
	// maven {
    //     url "https://oss.sonatype.org/content/repositories/com101tec-553"
    //}
}
dependencies {
	//compile 'com.101tec:zkclient:0.2'
	compile ('log4j:log4j:1.2.14') {
		exclude group: "com.sun.jdmk", module: "jmxtools"
        exclude group: "com.sun.jmx", module: "jmxri"
        exclude group: "javax.jms", module: "jms"
	}
	compile ('org.apache.zookeeper:zookeeper:3.3.1') {
		exclude group: "com.sun.jdmk", module: "jmxtools"
        exclude group: "com.sun.jmx", module: "jmxri"
        exclude group: "javax.jms", module: "jms"
	}
	testCompile 'junit:junit:4.7'
	testCompile 'commons-io:commons-io:1.4'
	testCompile 'org.mockito:mockito-core:1.8.0'
	
	//dependencies of mockito
	testCompile files('lib/objenesis-1.0.jar', 'lib/hamcrest-core-1.1.jar')
}


//--------------------
// Source Jar
//--------------------
task sourceJar(type: Jar) {
    classifier = 'sources'
    from sourceSets.main.allSource
}
task javadocJar(type: Jar, dependsOn:javadoc) {      
	classifier = 'javadoc'     
	from javadoc.destinationDir 
}   
artifacts {
	archives sourceJar      
    archives javadocJar
}
task jars(dependsOn: ['jar','sourceJar'], description: 'Build jar & source jar') << {}


//--------------------
// Eclipse Setup
//--------------------
eclipse {
    classpath {
    	defaultOutputDir = file('build-eclipse')
    }
}

task eclipseJdtPrepare(type: Copy) {
	from rootProject.file('src/build/eclipse/org.eclipse.jdt.core.prefs')
	into project.file('.settings/')
}
tasks["eclipseJdt"].dependsOn(eclipseJdtPrepare)

//--------------------
// Util methods
//--------------------
task wrapper(type: Wrapper, description: 'Generate the Gradle Wrapper') {
    gradleVersion = '1.3'
}

